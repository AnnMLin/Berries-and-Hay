(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{38:function(e,t,n){e.exports=n(65)},65:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(18),u=n.n(r),o=n(11),i=n(2),l=n(13),s=n(8),m=n(5),F=n.n(m),d=function(e){return{type:"GOT_USER",user:e}},f=function(e){return{type:"UPDATED_BALANCE",balance:e}},E=function(e,t){return function(n,a){F.a.put("/user/".concat(t,"/updateBalance/").concat(e)).then((function(e){n(f(e.data))})).catch((function(e){console.log("Error updating use balance:",e)}))}},b=function(e){return{type:"GOT_TRANSACTIONS",transactions:e}},v=function(e){return{type:"ADD_TRANSACTION",transaction:e}},g=function(e){return{type:"GOT_PORTFOLIO",portfolio:e}},p=function(e){return{type:"GOT_TOTAL_VALUE",totalValue:e}},h="GOT_TRANSACTIONS",D="ADD_TRANSACTION",O="GOT_PORTFOLIO",N="GOT_TOTAL_VALUE",j={createUser:function(e){var t=e.name,n=e.email,a=e.password;return function(e,c){return F.a.post("/auth/createUser",{name:t,email:n,password:a}).then((function(t){e(d(t.data))})).catch((function(t){console.log("Error creating user:",t),"SequelizeUniqueConstraintError"===t.response.data.name&&e(j.showWarning("Email already in use"))}))}},getUser:function(e){var t=e.email,n=e.password;return function(e){return F.a.put("/auth/login",{email:t,password:n}).then((function(t){console.log("USER in THUNK:",t),e(d(t.data))})).catch((function(t){console.log("Error logging in user:",t),401===t.response.status&&e(j.showWarning("Incorrect email or password"))}))}},gotUser:d,showWarning:function(e){return{type:"SHOW_WARNING",msg:e}},clearWarning:function(){return{type:"CLEAR_WARNING"}},getMe:function(){return function(e){return F.a.get("/auth/me").then((function(t){console.log("ME:",t.data),e(d(t.data))})).catch((function(e){return console.log("Error getting user:",e)}))}},logout:function(){return function(e){return F.a.delete("/auth/logout").then((function(){e(d({}))})).catch((function(e){console.log("Error deleting user:",e)}))}},buyShare:function(e,t){return function(n,a){return F.a.get("https://sandbox.iexapis.com/stable/stock/".concat(e,"/price?token=").concat("Tpk_45ef701c9b0f485583f9b8c7ce1e1920")).then((function(e){return e.data})).then((function(c){var r=c*t,u=a(),o=u.user.balance;if(o>=r){var i=u.user.id;n(E(o-r,i)),n(j.createTransaction({name:e,quantity:t,price:c}))}else n(j.showWarning("Not enough balance"))})).catch((function(e){console.log("Error buying share:",e),n(j.showWarning("Ticker symbol not valid"))}))}},updatedBalance:f,gotTransactions:b,addTransaction:v,getTransactions:function(){return function(e,t){var n=t().user.id;return F.a.get("/user/".concat(n,"/transactions")).then((function(t){e(b(t.data)),e(j.makePortfolio(t.data))})).catch((function(e){console.log("Error getting transactions:",e)}))}},createTransaction:function(e){return function(t,n){var a=n().user.id;return F.a.post("/user/".concat(a,"/create-transaction"),e).then((function(e){t(v(e.data));var a=n().transactions;t(j.makePortfolio(a))})).catch((function(e){console.log("Error creating transaction:",e)}))}},makePortfolio:function(){return function(e,t){var n=t().transactions,a={};n.forEach((function(e){a[e.name]?a[e.name].quantity+=Number([e.quantity]):(a[e.name]={},a[e.name].quantity=Number([e.quantity]))}));var c=0;return Promise.all(Object.keys(a).map((function(e){return F.a.get("https://sandbox.iexapis.com/stable/stock/".concat(e,"/price?token=").concat("Tpk_45ef701c9b0f485583f9b8c7ce1e1920")).then((function(e){return e.data})).then((function(t){console.log("GOT PRICE:",e);var n=t*a[e].quantity;a[e].price=Number(t.toFixed(2)),a[e].value=Number(n.toFixed(2)),c+=n,console.log("TOTALVALUE:",c)})).catch((function(t){console.log("Error occurs at",e,"Err:",t)}))}))).then((function(){return e(p(Number(c.toFixed(2))))})).then((function(){return e(function(e){return function(t){return Promise.all(Object.keys(e).map((function(t){return F.a.get("https://sandbox.iexapis.com/stable/stock/".concat(t,"/ohlc?token=").concat("Tpk_45ef701c9b0f485583f9b8c7ce1e1920")).then((function(e){return e.data})).then((function(n){n.open&&(console.log("OPEN PRICE:",t,n.open.price),e[t].openPrice=n.open.price)})).catch((function(e){console.log("Error occurs at",t,"Err:",e)}))}))).then((function(){return t(g(e))})).then((function(){console.log("SECOND STEP DONE!!!")})).catch((function(e){console.log("Error at gotPortfolio:",e)}))}}(a))})).then((function(){console.log("FIRST STEP DONE!!!")})).catch((function(e){console.log("Error at makePortfolio:",e)}))}},gotPortfolio:g,gotTotalValue:p},y="GOT_USER",A="UPDATED_BALANCE",x={},C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case y:return Object(s.a)({},t.user);case A:return Object(s.a)(Object(s.a)({},e),{},{balance:t.balance});default:return e}},w="SHOW_WARNING",T="CLEAR_WARNING",k=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case w:return t.msg;case T:return"";default:return e}},S=n(25),_=h,P=D,W=[],q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:W,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case _:return Object(S.a)(t.transactions);case P:return[].concat(Object(S.a)(e),[t.transaction]);default:return e}},z=O,R={},U=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case z:return t.portfolio;default:return e}},I=N,L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case I:return t.totalValue;default:return e}},G=Object(l.c)({user:C,warning:k,transactions:q,portfolio:U,totalValue:L}),$=n(37),B=Object(l.d)(G,Object(l.a)($.a)),V=n(3),H=function(){return c.a.createElement("div",{id:"create-user"},c.a.createElement(X,null))},M=function(){return c.a.createElement("div",{id:"log-in"},c.a.createElement(te,null))},J=function(){var e=Object(i.c)((function(e){return e.transactions})),t=Object(i.b)();return Object(a.useEffect)((function(){t(j.getTransactions())}),[]),c.a.createElement("div",{id:"transactions"},c.a.createElement("div",{className:"content-container"},c.a.createElement("div",{className:"title"},"Transactions"),c.a.createElement("div",{className:"content"},c.a.createElement("div",{className:"list"},e.map((function(e){var t=e.name,n=e.quantity,a=e.price;return c.a.createElement("div",{key:e.id,className:"list-item"},c.a.createElement("div",null,"BUY"),c.a.createElement("div",null,"".concat(t," - ").concat(n," Shares")),c.a.createElement("div",null,"@ ".concat(a)))}))))))},K=n(12),Q=n(15),Y=function(){var e=Object(i.c)((function(e){return e.user})),t=Object(i.c)((function(e){return e.warning})),n=Object(i.b)(),r=Object(i.c)((function(e){return e.portfolio})),u=Object(i.c)((function(e){return e.totalValue})),o=Object(a.useState)({ticker:"",qty:0}),l=Object(Q.a)(o,2),m=l[0],F=l[1],d=function(e){F(Object(s.a)(Object(s.a)({},m),{},Object(K.a)({},e.target.name,e.target.value)))},f=function(e){e.preventDefault(),m.ticker?!m.qty||m.qty<=0?n(j.showWarning("Please enter a valid quantity")):(n(j.clearWarning()),n(j.buyShare(m.ticker.toUpperCase(),m.qty))):n(j.showWarning("Please enter ticker"))};return Object(a.useEffect)((function(){n(j.getTransactions())}),[]),Object(a.useEffect)((function(){F({ticker:"",qty:0})}),[e.balance]),c.a.createElement("div",{id:"portfolio"},c.a.createElement("div",{className:"content-container"},c.a.createElement("div",{className:"title"},"Portfolio ($".concat(u,")")),c.a.createElement("div",{className:"content"},c.a.createElement("div",{className:"list"},Object.keys(r).length?Object.keys(r).map((function(e){console.log(e,":",r[e]);var t=r[e].quantity,n=r[e].price,a=r[e].value,u=r[e].openPrice;console.log(n,u);var o="";return o=n>u?"green":n<u?"red":"grey",c.a.createElement("div",{key:e,className:"list-item ".concat(o)},c.a.createElement("div",null,"".concat(e," - ").concat(t," Shares")),c.a.createElement("div",null,"$".concat(a)))})):"LOADING..."),c.a.createElement("div",{id:"buy-shares"},c.a.createElement("div",{id:"balance"},"Balance : $".concat(e.balance)),c.a.createElement("form",{id:"buy-shares-form",className:"form",onSubmit:f},c.a.createElement("div",{className:"form-item"},c.a.createElement("div",null,c.a.createElement("div",null,"Ticker:"),c.a.createElement("input",{id:"ticker",type:"string",name:"ticker",value:m.ticker,onChange:d})),c.a.createElement("div",null,c.a.createElement("div",null,"Quantity:"),c.a.createElement("input",{id:"qty",type:"number",name:"qty",value:m.qty,onChange:d})),c.a.createElement("div",{className:"btn-container"},c.a.createElement("div",{className:"btn-item"},c.a.createElement("div",{className:"btn",type:"submit",onClick:f},"Submit")),t?c.a.createElement("div",{className:"warning"},t):null)))))))},X=function(){var e=Object(a.useState)({name:"",email:"",password:""}),t=Object(Q.a)(e,2),n=t[0],r=t[1],u=Object(i.c)((function(e){return e.warning})),o=Object(i.b)(),l=Object(V.f)(),m=function(e){r(Object(s.a)(Object(s.a)({},n),{},Object(K.a)({},e.target.name,e.target.value)))},F=function(e){e.preventDefault(),n.name&&n.email&&n.password?d(n.email)?(o(j.clearWarning()),o(j.createUser(n)).then((function(){l.push("/home")}))):o(j.showWarning("Please enter a valid email *")):o(j.showWarning("All fields required *"))},d=function(e){return/(?!.*\.{2})^([a-z\d!#$%&'*+\-\/=?^_`{|}~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+(\.[a-z\d!#$%&'*+\-\/=?^_`{|}~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+)*|"((([ \t]*\r\n)?[ \t]+)?([\x01-\x08\x0b\x0c\x0e-\x1f\x7f\x21\x23-\x5b\x5d-\x7e\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|\\[\x01-\x09\x0b\x0c\x0d-\x7f\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))*(([ \t]*\r\n)?[ \t]+)?")@(([a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|[a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF][a-z\d\-._~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]*[a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])\.)+([a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|[a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF][a-z\d\-._~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]*[a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])\.?$/i.test(String(e).toLowerCase())};return Object(a.useEffect)((function(){o(j.clearWarning())}),[]),c.a.createElement("form",{className:"form",onSubmit:F},c.a.createElement("div",{className:"modal-title"},"Register"),c.a.createElement("div",{className:"form-item"},c.a.createElement("div",{id:"sign-up-name"},c.a.createElement("div",null,"Name:"),c.a.createElement("input",{type:"text",name:"name",value:n.name,onChange:m})),c.a.createElement("div",{id:"sign-up-email"},c.a.createElement("div",null,"Email:"),c.a.createElement("input",{type:"text",name:"email",value:n.email,onChange:m})),c.a.createElement("div",{id:"sign-up-password"},c.a.createElement("div",null,"Password:"),c.a.createElement("input",{type:"text",name:"password",value:n.password,onChange:m})),c.a.createElement("div",{className:"btn-container"},c.a.createElement("div",{className:"btn-item"},c.a.createElement("div",{className:"btn",type:"submit",onClick:F},"Submit")),u?c.a.createElement("div",{className:"warning"},u):null)))},Z=function(){var e=Object(i.c)((function(e){return e}));Object(i.c)((function(e){return e.user}));console.log("CURRENT STATE:",e);var t=Object(V.g)();return c.a.createElement("div",{id:"home"},c.a.createElement(ee,null),c.a.createElement(V.c,null,c.a.createElement(V.a,{path:"".concat(t.url,"/transactions"),component:J}),c.a.createElement(V.a,{path:"".concat(t.url),component:Y})))},ee=function(){var e=Object(V.g)(),t=Object(i.b)(),n=Object(V.f)(),a=Object(i.c)((function(e){return e.user}));return c.a.createElement("div",{id:"navbar"},c.a.createElement("div",{id:"navbar-content"},c.a.createElement("div",{id:"hello"},"Hello ".concat(a.name,"!")),c.a.createElement("div",{id:"options"},c.a.createElement("div",{id:"navs"},c.a.createElement(o.b,{to:"".concat(e.url)},"Portfolio"),c.a.createElement("div",null,"|"),c.a.createElement(o.b,{to:"".concat(e.url,"/transactions")},"Transactions")),c.a.createElement("div",{className:"btn-container"},c.a.createElement("div",{className:"btn-item"},c.a.createElement("div",{className:"btn",onClick:function(){t(j.logout()).then((function(){n.push("/")}))}},"Log out"))))))},te=function(){var e=Object(a.useState)({email:"",password:""}),t=Object(Q.a)(e,2),n=t[0],r=t[1],u=Object(i.c)((function(e){return e.warning})),l=Object(i.b)(),m=Object(V.f)(),F=function(e){r(Object(s.a)(Object(s.a)({},n),{},Object(K.a)({},e.target.name,e.target.value)))},d=function(e){e.preventDefault(),n.email&&n.password?f(n.email)?(l(j.clearWarning()),l(j.getUser(n)).then((function(){m.push("/home")}))):l(j.showWarning("Please enter a valid email *")):l(j.showWarning("All fields required *"))},f=function(e){return/(?!.*\.{2})^([a-z\d!#$%&'*+\-\/=?^_`{|}~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+(\.[a-z\d!#$%&'*+\-\/=?^_`{|}~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+)*|"((([ \t]*\r\n)?[ \t]+)?([\x01-\x08\x0b\x0c\x0e-\x1f\x7f\x21\x23-\x5b\x5d-\x7e\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|\\[\x01-\x09\x0b\x0c\x0d-\x7f\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))*(([ \t]*\r\n)?[ \t]+)?")@(([a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|[a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF][a-z\d\-._~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]*[a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])\.)+([a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|[a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF][a-z\d\-._~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]*[a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])\.?$/i.test(String(e).toLowerCase())};return c.a.createElement("form",{className:"form",onSubmit:d},c.a.createElement("div",{className:"modal-title"},"Sign In"),c.a.createElement("div",{className:"form-item"},c.a.createElement("div",{id:"sign-in-email"},c.a.createElement("div",null,"Email:"),c.a.createElement("input",{type:"text",name:"email",value:n.email,onChange:F})),c.a.createElement("div",{id:"sign-in-password"},c.a.createElement("div",null,"Password:"),c.a.createElement("input",{type:"text",name:"password",value:n.password,onChange:F})),c.a.createElement("div",{className:"btn-container"},c.a.createElement("div",{className:"btn-item"},c.a.createElement("div",{className:"btn",type:"submit",onClick:d},"Submit")),u?c.a.createElement("div",{className:"warning"},u):null),c.a.createElement("div",{className:"reminder"},c.a.createElement("div",null,"Don't have an account?"),c.a.createElement(o.b,{to:"/create-user",className:"create-account-link"},"Create an account"))))},ne=function(){var e=Object(i.c)((function(e){return e.user})),t=Object(i.b)(),n=Object(V.f)();return Object(a.useEffect)((function(){t(j.getMe())}),[]),Object(a.useEffect)((function(){e.id&&n.push("/home")}),[e]),c.a.createElement("div",{id:"app"},c.a.createElement(V.c,null,c.a.createElement(V.a,{exact:!0,path:"/",component:M}),c.a.createElement(V.a,{path:"/create-user",component:H}),e.id&&c.a.createElement(V.a,{path:"/Home",component:Z}),c.a.createElement(V.a,{path:"/*",component:M})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ae=n(6);Object(ae.a)();u.a.render(c.a.createElement(i.a,{store:B},c.a.createElement(o.a,null,c.a.createElement(ne,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[38,1,2]]]);
//# sourceMappingURL=main.fe827836.chunk.js.map